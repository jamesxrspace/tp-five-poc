module "storage" {
  source                           = "../../modules/storage"
  number_of_azs                    = 2
  eks_availability_zones           = data.terraform_remote_state.network.outputs.eks_availability_zones
  network_block                    = data.terraform_remote_state.network.outputs.network_block
  eks_private_subnet_CIDR          = data.terraform_remote_state.network.outputs.eks_private_subnet_CIDR
  vpc_id                           = data.terraform_remote_state.network.outputs.vpc_id
  eks_private_subnets              = data.terraform_remote_state.network.outputs.eks_private_subnets
  private_subnet_prefix_extension  = 8
  private_zone_offset              = 4
  postgres_private_zone_offset     = 6
  environment                      = local.environment
  service                          = local.service
  eks_node_security_group_id       = data.terraform_remote_state.eks.outputs.node_security_group_id
  redis_node_type                  = "cache.t3.micro"
  redis_number_cache_clusters      = 2
  redis_engine_version             = "7.0"
  redis_parameter_group_name       = "default.redis7"
  redis_automatic_failover_enabled = true
  redis_multi_az_enabled           = true
  redis_snapshot_window            = "01:00-02:00"
  redis_snapshot_retention_limit   = 1
  redis_maintenance_window         = "tue:06:30-tue:07:30"
  aws_region                       = local.aws_region
  org_id                           = "5ea2b870656a030760cad8d4" # mongo atlas org ID
  provider_instance_size_name      = "M10"
  mongodb_dbname                   = "xrspace"
  mongodb_username                 = local.mongodb_user_creds.username
  mongodb_password                 = local.mongodb_user_creds.password
  cms_acm_arn                      = "arn:aws:acm:us-east-1:047401700492:certificate/929d2a10-aed8-4afd-8042-a5f45d45a841"
  cms_domain_name                  = "cms.dev.xrspace.io"
  postgres_instance_class          = "db.t3.micro"
  postgres_engine_version          = "15.5"
  postgres_db_name                 = "xrspace"
  postgres_username                = local.postgres_user_creds.username
  postgres_password                = local.postgres_user_creds.password
  postgres_maintenance_window      = "tue:06:30-tue:07:30"
  postgres_snapshot_identifier     = "xrspace-postgres-snapshot"
  postgres_backup_retention_limit  = 1
}
